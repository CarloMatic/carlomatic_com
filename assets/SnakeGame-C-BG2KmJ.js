import{r as n,j as e,A as E,m as R,X as T}from"./index-MXEgoAKm.js";const a=15,P=130,D={pixel:"#43523d"};function G({onClose:b}){const[S,g]=n.useState([{x:7,y:7}]),[d,w]=n.useState({x:10,y:4}),[u,y]=n.useState(!1),[v,N]=n.useState(0),[f,k]=n.useState(!1),i=n.useRef("RIGHT"),x=n.useRef(null),m=()=>{g([{x:7,y:7}]),w(j()),i.current="RIGHT",y(!1),N(0),k(!0)},j=()=>({x:Math.floor(Math.random()*a),y:Math.floor(Math.random()*a)}),p=n.useCallback(o=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," ","PageUp","PageDown","Home","End"].includes(o.key)&&o.preventDefault(),!f||u)return;const t={ArrowUp:"UP",w:"UP",2:"UP",ArrowDown:"DOWN",s:"DOWN",8:"DOWN",ArrowLeft:"LEFT",a:"LEFT",4:"LEFT",ArrowRight:"RIGHT",d:"RIGHT",6:"RIGHT"}[o.key];if(!t)return;const r=i.current;t==="UP"&&r==="DOWN"||t==="DOWN"&&r==="UP"||t==="LEFT"&&r==="RIGHT"||t==="RIGHT"&&r==="LEFT"||(i.current=t)},[f,u]);n.useEffect(()=>(window.addEventListener("keydown",p,{passive:!1}),document.body.style.overflow="hidden",()=>{window.removeEventListener("keydown",p),document.body.style.overflow="unset",x.current&&clearInterval(x.current)}),[p]),n.useEffect(()=>{if(u||!f)return;const o=()=>{g(s=>{const t={...s[0]},r=i.current;if(r==="UP"&&(t.y-=1),r==="DOWN"&&(t.y+=1),r==="LEFT"&&(t.x-=1),r==="RIGHT"&&(t.x+=1),t.x<0||t.x>=a||t.y<0||t.y>=a||s.some(l=>l.x===t.x&&l.y===t.y))return y(!0),s;const c=[t,...s];return t.x===d.x&&t.y===d.y?(N(l=>l+1),w(j())):c.pop(),c})};return x.current=window.setInterval(o,P),()=>{x.current&&clearInterval(x.current)}},[u,f,d]);const h=o=>{const s=i.current;o==="UP"&&s==="DOWN"||o==="DOWN"&&s==="UP"||o==="LEFT"&&s==="RIGHT"||o==="RIGHT"&&s==="LEFT"||(i.current=o)};return e.jsx(E,{children:e.jsxs(R.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 overflow-hidden",onClick:o=>o.target===o.currentTarget&&b(),children:[e.jsx("button",{onClick:b,className:"absolute top-6 right-6 text-white hover:text-red-500 transition-colors z-[60]",children:e.jsx(T,{size:40})}),e.jsxs(R.div,{initial:{scale:.8,y:100},animate:{scale:1,y:0},className:"relative max-w-full h-auto max-h-[85vh] aspect-[960/1765] select-none",onClick:o=>o.stopPropagation(),children:[e.jsx("img",{src:"/images/nokia_3310.png",alt:"Nokia 3310",className:"w-full h-full object-contain drop-shadow-2xl"}),e.jsxs("div",{className:"absolute bg-[#c7f0d8] overflow-hidden",style:{top:"24%",left:"24%",width:"52%",height:"17%",borderRadius:"10% / 20%",boxShadow:"inset 0 0 10px rgba(0,0,0,0.2)"},children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjZmZmIiAvPgo8cmVjdCB3aWR0aD0iMSIgaGVpZ2h0PSIxIiBmaWxsPSIjMDAwIiAvPgo8L3N2Zz4=')] opacity-[0.08]"}),f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-[2px] right-[4px] text-[#43523d] font-mono text-[10px] font-bold z-10 leading-none",children:v.toString().padStart(3,"0")}),e.jsx("div",{className:"w-full h-full grid p-[6%]",style:{gridTemplateColumns:`repeat(${a}, 1fr)`,gridTemplateRows:`repeat(${a}, 1fr)`},children:Array.from({length:a*a}).map((o,s)=>{const t=s%a,r=Math.floor(s/a);let c=!1,l=d.x===t&&d.y===r;return S.forEach(I=>{I.x===t&&I.y===r&&(c=!0)}),e.jsx("div",{style:{backgroundColor:c||l?D.pixel:"transparent"},className:`w-full h-full ${l?"transform rotate-45 scale-75":""} ${c?"border-[0.5px] border-[#c7f0d8]":""}`},s)})})]}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-[#43523d] space-y-1",children:[e.jsx("h2",{className:"text-xl font-bold font-mono tracking-tighter",children:"SNAKE II"}),e.jsxs("p",{className:"text-[10px] font-mono",children:["HIGH: ",localStorage.getItem("snake_highscore")||0]}),e.jsx("button",{onClick:m,className:"animate-pulse bg-[#43523d] text-[#c7f0d8] px-3 py-0.5 font-bold font-mono text-xs rounded-sm mt-1",children:"PRESS START"})]}),u&&e.jsxs("div",{className:"absolute inset-0 bg-[#c7f0d8]/95 flex flex-col items-center justify-center text-[#43523d] z-20",children:[e.jsx("h2",{className:"text-lg font-bold font-mono mb-1",children:"GAME OVER"}),e.jsxs("p",{className:"font-mono text-xs mb-2",children:["SCORE: ",v]}),e.jsx("button",{onClick:m,className:"border-2 border-[#43523d] px-2 py-0.5 font-bold font-mono text-[10px] hover:bg-[#43523d] hover:text-[#c7f0d8]",children:"AGAIN"})]})]}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 rounded-[30%]",style:{top:"48%",left:"42%",width:"16%",height:"5%"},onClick:m}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 rounded-full",style:{top:"61%",left:"43%",width:"14%",height:"4%"},onClick:()=>h("UP")}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 rounded-full",style:{top:"75%",left:"43%",width:"14%",height:"4%"},onClick:()=>h("DOWN")}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 rounded-full",style:{top:"68%",left:"23%",width:"14%",height:"4%"},onClick:()=>h("LEFT")}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 rounded-full",style:{top:"68%",left:"63%",width:"14%",height:"4%"},onClick:()=>h("RIGHT")})]})]})})}export{G as SnakeGame};
