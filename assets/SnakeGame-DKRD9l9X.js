import{r,j as e,A as E,m as S,X as P}from"./index-Cna2HkMV.js";const c=20,m=12,D=180,A={pixel:"#43523d"};function G({onClose:g}){const[k,w]=r.useState([{x:10,y:6}]),[d,y]=r.useState({x:15,y:5}),[u,v]=r.useState(!1),[N,j]=r.useState(0),[f,T]=r.useState(!1),l=r.useRef("RIGHT"),x=r.useRef(null),p=()=>{w([{x:5,y:6},{x:4,y:6},{x:3,y:6}]),y(I()),l.current="RIGHT",v(!1),j(0),T(!0)},I=()=>({x:Math.floor(Math.random()*c),y:Math.floor(Math.random()*m)}),b=r.useCallback(o=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," ","PageUp","PageDown","Home","End"].includes(o.key)&&o.preventDefault(),!f||u)return;const t={ArrowUp:"UP",w:"UP",2:"UP",ArrowDown:"DOWN",s:"DOWN",8:"DOWN",ArrowLeft:"LEFT",a:"LEFT",4:"LEFT",ArrowRight:"RIGHT",d:"RIGHT",6:"RIGHT"}[o.key];if(!t)return;const n=l.current;t==="UP"&&n==="DOWN"||t==="DOWN"&&n==="UP"||t==="LEFT"&&n==="RIGHT"||t==="RIGHT"&&n==="LEFT"||(l.current=t)},[f,u]);r.useEffect(()=>(window.addEventListener("keydown",b,{passive:!1}),document.body.style.overflow="hidden",()=>{window.removeEventListener("keydown",b),document.body.style.overflow="unset",x.current&&clearInterval(x.current)}),[b]),r.useEffect(()=>{if(u||!f)return;const o=()=>{w(s=>{const t={...s[0]},n=l.current;if(n==="UP"&&(t.y-=1),n==="DOWN"&&(t.y+=1),n==="LEFT"&&(t.x-=1),n==="RIGHT"&&(t.x+=1),t.x<0||t.x>=c||t.y<0||t.y>=m||s.some(a=>a.x===t.x&&a.y===t.y))return v(!0),s;const i=[t,...s];return t.x===d.x&&t.y===d.y?(j(a=>a+1),y(I())):i.pop(),i})};return x.current=window.setInterval(o,D),()=>{x.current&&clearInterval(x.current)}},[u,f,d]);const h=o=>{const s=l.current;o==="UP"&&s==="DOWN"||o==="DOWN"&&s==="UP"||o==="LEFT"&&s==="RIGHT"||o==="RIGHT"&&s==="LEFT"||(l.current=o)};return e.jsx(E,{children:e.jsxs(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 overflow-hidden",onClick:o=>o.target===o.currentTarget&&g(),children:[e.jsx("button",{onClick:g,className:"absolute top-6 right-6 text-white hover:text-red-500 transition-colors z-[60]",children:e.jsx(P,{size:40})}),e.jsxs(S.div,{initial:{scale:.8,y:100},animate:{scale:1,y:0},className:"relative max-w-full h-auto max-h-[85vh] aspect-[960/1765] select-none",onClick:o=>o.stopPropagation(),children:[e.jsx("img",{src:"/images/nokia_3310.png",alt:"Nokia 3310",className:"w-full h-full object-contain drop-shadow-2xl"}),e.jsxs("div",{className:"absolute bg-[#c7f0d8] overflow-hidden",style:{top:"calc(24% + 25px)",left:"calc(24% - 9px)",width:"calc(52% + 4px)",height:"calc(17% + 21px)",borderRadius:"5% / 10%",boxShadow:"inset 0 0 10px rgba(0,0,0,0.2)"},children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjZmZmIiAvPgo8cmVjdCB3aWR0aD0iMSIgaGVpZ2h0PSIxIiBmaWxsPSIjMDAwIiAvPgo8L3N2Zz4=')] opacity-[0.08]"}),f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-[2px] right-[9px] text-[#43523d] font-mono text-[10px] font-bold z-10 leading-none",children:N.toString().padStart(3,"0")}),e.jsx("div",{className:"w-full h-full grid p-[6%]",style:{gridTemplateColumns:`repeat(${c}, 1fr)`,gridTemplateRows:`repeat(${m}, 1fr)`},children:Array.from({length:c*m}).map((o,s)=>{const t=s%c,n=Math.floor(s/c);let i=!1,a=d.x===t&&d.y===n;return k.forEach(R=>{R.x===t&&R.y===n&&(i=!0)}),e.jsx("div",{style:{backgroundColor:i||a?A.pixel:"transparent"},className:`w-full h-full ${a?"transform rotate-45 scale-75":""} ${i?"border-[0.5px] border-[#c7f0d8]":""}`},s)})})]}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-[#43523d] space-y-1",children:[e.jsx("h2",{className:"text-xl font-bold font-mono tracking-tighter",children:"SNAKE II"}),e.jsxs("p",{className:"text-[10px] font-mono",children:["HIGH: ",localStorage.getItem("snake_highscore")||0]}),e.jsx("button",{onClick:p,className:"animate-pulse bg-[#43523d] text-[#c7f0d8] px-3 py-0.5 font-bold font-mono text-xs rounded-sm mt-1",children:"PRESS START"})]}),u&&e.jsxs("div",{className:"absolute inset-0 bg-[#c7f0d8]/95 flex flex-col items-center justify-center text-[#43523d] z-20",children:[e.jsx("h2",{className:"text-lg font-bold font-mono mb-1",children:"GAME OVER"}),e.jsxs("p",{className:"font-mono text-xs mb-2",children:["SCORE: ",N]}),e.jsx("button",{onClick:p,className:"border-2 border-[#43523d] px-2 py-0.5 font-bold font-mono text-[10px] hover:bg-[#43523d] hover:text-[#c7f0d8]",children:"AGAIN"})]})]}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 rounded-[30%]",style:{top:"48%",left:"42%",width:"16%",height:"5%"},onClick:p}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 rounded-full",style:{top:"61%",left:"43%",width:"14%",height:"4%"},onClick:()=>h("UP")}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 rounded-full",style:{top:"75%",left:"43%",width:"14%",height:"4%"},onClick:()=>h("DOWN")}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 rounded-full",style:{top:"68%",left:"23%",width:"14%",height:"4%"},onClick:()=>h("LEFT")}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 rounded-full",style:{top:"68%",left:"63%",width:"14%",height:"4%"},onClick:()=>h("RIGHT")})]})]})})}export{G as SnakeGame};
