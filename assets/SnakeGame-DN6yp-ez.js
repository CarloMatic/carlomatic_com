import{r as s,j as e,b as T,m as k,X as D}from"./index-C3jsO-J-.js";const c=20,b=12,A=180,G={pixel:"#43523d"};function H({onClose:v}){const[P,N]=s.useState([{x:10,y:6}]),[d,j]=s.useState({x:15,y:5}),[h,I]=s.useState(!1),[m,R]=s.useState(0),[u,E]=s.useState(!1),i=s.useRef("RIGHT"),f=s.useRef(null),w=()=>{N([{x:5,y:6},{x:4,y:6},{x:3,y:6}]),j(S()),i.current="RIGHT",I(!1),R(0),E(!0)},S=()=>({x:Math.floor(Math.random()*c),y:Math.floor(Math.random()*b)}),y=s.useCallback(t=>{if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"," ","PageUp","PageDown","Home","End"].includes(t.key)&&t.preventDefault(),!u||h)return;const n={ArrowUp:"UP",w:"UP",2:"UP",ArrowDown:"DOWN",s:"DOWN",8:"DOWN",ArrowLeft:"LEFT",a:"LEFT",4:"LEFT",ArrowRight:"RIGHT",d:"RIGHT",6:"RIGHT"}[t.key];if(!n)return;const a=i.current;n==="UP"&&a==="DOWN"||n==="DOWN"&&a==="UP"||n==="LEFT"&&a==="RIGHT"||n==="RIGHT"&&a==="LEFT"||(i.current=n)},[u,h]);s.useEffect(()=>(window.addEventListener("keydown",y,{passive:!1}),document.body.style.overflow="hidden",()=>{window.removeEventListener("keydown",y),document.body.style.overflow="unset",f.current&&clearInterval(f.current)}),[y]),s.useEffect(()=>{if(h||!u)return;const t=Math.floor(m/10),r=Math.max(50,Math.floor(A*Math.pow(.9,t))),n=()=>{N(a=>{const o={...a[0]},l=i.current;if(l==="UP"&&(o.y-=1),l==="DOWN"&&(o.y+=1),l==="LEFT"&&(o.x-=1),l==="RIGHT"&&(o.x+=1),o.x<0||o.x>=c||o.y<0||o.y>=b||a.some(g=>g.x===o.x&&g.y===o.y))return I(!0),a;const x=[o,...a];return o.x===d.x&&o.y===d.y?(R(g=>g+1),j(S())):x.pop(),x})};return f.current=window.setInterval(n,r),()=>{f.current&&clearInterval(f.current)}},[h,u,d,m]);const p=t=>{const r=i.current;t==="UP"&&r==="DOWN"||t==="DOWN"&&r==="UP"||t==="LEFT"&&r==="RIGHT"||t==="RIGHT"&&r==="LEFT"||(i.current=t)};return e.jsx(T,{children:e.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 overflow-hidden",onClick:t=>t.target===t.currentTarget&&v(),children:[e.jsx("button",{onClick:v,className:"absolute top-6 right-6 text-white hover:text-red-500 transition-colors z-[60]",children:e.jsx(D,{size:40})}),e.jsxs(k.div,{initial:{scale:.8,y:100},animate:{scale:1,y:0},className:"relative max-w-full h-auto max-h-[85vh] aspect-[960/1765] select-none",onClick:t=>t.stopPropagation(),children:[e.jsx("img",{src:"/images/nokia-3310-snake-game-retro.webp",alt:"Nokia 3310 Retro Phone Frame for Snake Game",className:"w-full h-full object-contain drop-shadow-2xl"}),e.jsxs("div",{className:"absolute bg-[#c7f0d8] overflow-hidden",style:{top:"calc(24% + 25px)",left:"calc(24% - 9px)",width:"calc(52% + 2px)",height:"calc(17% + 18px)",borderRadius:"5% / 10%",boxShadow:"inset 0 0 10px rgba(0,0,0,0.2)"},children:[e.jsx("div",{className:"absolute inset-0 pointer-events-none opacity-10 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0IiBoZWlnaHQ9IjQiPgo8cmVjdCB3aWR0aD0iNCIgaGVpZ2h0PSI0IiBmaWxsPSIjZmZmIiAvPgo8cmVjdCB3aWR0aD0iMSIgaGVpZ2h0PSIxIiBmaWxsPSIjMDAwIiAvPgo8L3N2Zz4=')] opacity-[0.08]"}),u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-[2px] right-[9px] text-[#43523d] font-mono text-[10px] font-bold z-10 leading-none",children:m.toString().padStart(3,"0")}),e.jsx("div",{className:"w-full h-full grid p-[2%] border-2 border-[#43523d]/40 rounded-sm",style:{gridTemplateColumns:`repeat(${c}, 1fr)`,gridTemplateRows:`repeat(${b}, 1fr)`},children:Array.from({length:c*b}).map((t,r)=>{const n=r%c,a=Math.floor(r/c);let o=!1;const l=d.x===n&&d.y===a;return P.forEach(x=>{x.x===n&&x.y===a&&(o=!0)}),e.jsx("div",{style:{backgroundColor:o||l?G.pixel:"transparent"},className:`w-full h-full ${l?"transform rotate-45 scale-75":""} ${o?"border-[0.5px] border-[#c7f0d8]":""}`},r)})})]}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-[#43523d] space-y-1",children:[e.jsx("p",{className:"text-[10px] font-mono animate-pulse",children:"EasterEgg unlocked"}),e.jsx("h2",{className:"text-xl font-bold font-mono tracking-tighter",children:"SNAKE II"}),e.jsxs("p",{className:"text-[10px] font-mono",children:["HIGH: ",localStorage.getItem("snake_highscore")||0]}),e.jsx("button",{onClick:w,className:"animate-pulse bg-[#43523d] text-[#c7f0d8] px-3 py-0.5 font-bold font-mono text-xs rounded-sm mt-1",children:"PRESS START"})]}),h&&e.jsxs("div",{className:"absolute inset-0 bg-[#c7f0d8]/95 flex flex-col items-center justify-center text-[#43523d] z-20",children:[e.jsx("h2",{className:"text-lg font-bold font-mono mb-1",children:"GAME OVER"}),e.jsxs("p",{className:"font-mono text-xs mb-2",children:["SCORE: ",m]}),e.jsx("button",{onClick:w,className:"border-2 border-[#43523d] px-2 py-0.5 font-bold font-mono text-[10px] hover:bg-[#43523d] hover:text-[#c7f0d8]",children:"AGAIN"})]})]}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 rounded-[30%]",style:{top:"48%",left:"42%",width:"16%",height:"5%"},onClick:w}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 active:bg-white/20 rounded-full z-50 tap-highlight-transparent",style:{top:"64%",left:"42%",width:"16%",height:"5%"},onClick:t=>{t.stopPropagation(),p("UP")},"aria-label":"Up"}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 active:bg-white/20 rounded-full z-50 tap-highlight-transparent",style:{top:"75%",left:"42%",width:"16%",height:"5%"},onClick:t=>{t.stopPropagation(),p("DOWN")},"aria-label":"Down"}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 active:bg-white/20 rounded-full z-50 tap-highlight-transparent",style:{top:"70%",left:"26%",width:"16%",height:"5%"},onClick:t=>{t.stopPropagation(),p("LEFT")},"aria-label":"Left"}),e.jsx("button",{className:"absolute bg-white/0 hover:bg-white/10 active:bg-white/20 rounded-full z-50 tap-highlight-transparent",style:{top:"70%",left:"58%",width:"16%",height:"5%"},onClick:t=>{t.stopPropagation(),p("RIGHT")},"aria-label":"Right"})]})]})})}export{H as SnakeGame};
